'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

var _desired = require('./desired');

var _desired2 = _interopRequireDefault(_desired);

var _safariSetup = require('../safari-setup');

var _safariSetup2 = _interopRequireDefault(_safariSetup);

var _helpersWebview = require('../../helpers/webview');

var _helpersEnv = require('../../helpers/env');

var _helpersEnv2 = _interopRequireDefault(_helpersEnv);

var _helpersSession = require('../../helpers/session');

var GET_ELEM_SYNC = 'return document.getElementsByTagName(\'h1\')[0].innerHTML;';
var GET_ELEM_ASYNC = 'arguments[arguments.length - 1](document.getElementsByTagName(\'h1\')[0].innerHTML);';

var FRAMESET_TITLE = 'Frameset guinea pig';
var IFRAME_FRAMESET_TITLE = 'Iframe guinea pig';
var SUB_FRAME_1_TITLE = 'Sub frame 1';
var SUB_FRAME_2_TITLE = 'Sub frame 2';
var SUB_FRAME_3_TITLE = 'Sub frame 3';

describe('safari - webview - frames', function () {
  this.timeout(_helpersSession.MOCHA_SAFARI_TIMEOUT);

  var driver = (0, _safariSetup2['default'])(this, _desired2['default']).driver;

  describe('frames', function () {
    var _this = this;

    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver, _helpersEnv2['default'].TEST_END_POINT + 'frameset.html', 'Frameset guinea pig'));

          case 2:
            return context$3$0.abrupt('return', context$3$0.sent);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to frame by name', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_1_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to frame by index', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame(1));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_2_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to frame by id', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('frame3'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_3_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch back to default content from frame', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_1_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);
            context$3$0.next = 15;
            return _regeneratorRuntime.awrap(driver.setFrame(null));

          case 15:
            context$3$0.next = 17;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'frameset'));

          case 17:
            context$3$0.sent.should.exist;

          case 18:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should switch to child frames', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('third'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.setFrame('childframe'));

          case 8:
            context$3$0.next = 10;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'only_on_page_2'));

          case 10:
            context$3$0.sent.should.exist;

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should execute javascript in frame', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.execute(GET_ELEM_SYNC));

          case 4:
            context$3$0.t0 = SUB_FRAME_1_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should execute async javascript in frame', function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.executeAsync(GET_ELEM_ASYNC));

          case 4:
            context$3$0.t0 = SUB_FRAME_1_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);

          case 6:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this);
    });

    it('should get source within a frame', function callee$2$0() {
      var pageSource, frameSource;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 2:
            pageSource = context$3$0.sent;

            pageSource.should.include(FRAMESET_TITLE);

            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.setFrame('first'));

          case 6:
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 8:
            frameSource = context$3$0.sent;

            frameSource.should.include(SUB_FRAME_1_TITLE);
            frameSource.should.not.include(FRAMESET_TITLE);

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });

  describe('iframes', function () {
    var _this2 = this;

    beforeEach(function callee$2$0() {
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap((0, _helpersWebview.loadWebView)(_desired2['default'], driver, _helpersEnv2['default'].TEST_END_POINT + 'iframes.html', 'Iframe guinea pig'));

          case 2:
            return context$3$0.abrupt('return', context$3$0.sent);

          case 3:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by name', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('iframe1'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = IFRAME_FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_1_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by index', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame(1));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = IFRAME_FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_2_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by id', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('id-iframe3'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = IFRAME_FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_3_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 13:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch to iframe by element', function callee$2$0() {
      var frame, h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('id', 'id-iframe3'));

          case 2:
            frame = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.setFrame(frame));

          case 5:
            context$3$0.next = 7;
            return _regeneratorRuntime.awrap(driver.title());

          case 7:
            context$3$0.t0 = IFRAME_FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 11:
            h1 = context$3$0.sent;
            context$3$0.next = 14;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 14:
            context$3$0.t1 = SUB_FRAME_3_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);

          case 16:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should not switch to iframe by element of wrong type', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 2:
            h1 = context$3$0.sent;
            context$3$0.next = 5;
            return _regeneratorRuntime.awrap(driver.setFrame(h1).should.eventually.be.rejected);

          case 5:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should switch back to default content from iframe', function callee$2$0() {
      var h1;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.setFrame('iframe1'));

          case 2:
            context$3$0.next = 4;
            return _regeneratorRuntime.awrap(driver.title());

          case 4:
            context$3$0.t0 = IFRAME_FRAMESET_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t0);
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.findElement('tag name', 'h1'));

          case 8:
            h1 = context$3$0.sent;
            context$3$0.next = 11;
            return _regeneratorRuntime.awrap(driver.getText(h1));

          case 11:
            context$3$0.t1 = SUB_FRAME_1_TITLE;
            context$3$0.sent.should.be.equal(context$3$0.t1);
            context$3$0.next = 15;
            return _regeneratorRuntime.awrap(driver.setFrame(null));

          case 15:
            context$3$0.next = 17;
            return _regeneratorRuntime.awrap(driver.findElements('tag name', 'iframe'));

          case 17:
            context$3$0.sent.should.have.length(3);

          case 18:
          case 'end':
            return context$3$0.stop();
        }
      }, null, _this2);
    });

    it('should get source within an iframe', function callee$2$0() {
      var pageSource, frameSource;
      return _regeneratorRuntime.async(function callee$2$0$(context$3$0) {
        while (1) switch (context$3$0.prev = context$3$0.next) {
          case 0:
            context$3$0.next = 2;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 2:
            pageSource = context$3$0.sent;

            pageSource.should.include(IFRAME_FRAMESET_TITLE);

            context$3$0.next = 6;
            return _regeneratorRuntime.awrap(driver.setFrame('iframe1'));

          case 6:
            context$3$0.next = 8;
            return _regeneratorRuntime.awrap(driver.getPageSource());

          case 8:
            frameSource = context$3$0.sent;

            frameSource.should.include(SUB_FRAME_1_TITLE);
            frameSource.should.not.include(IFRAME_FRAMESET_TITLE);

          case 11:
          case 'end':
            return context$3$0.stop();
        }
      }, null, this);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvZTJlL3NhZmFyaS93ZWJ2aWV3L2ZyYW1lcy1zcGVjcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7dUJBQW9CLFdBQVc7Ozs7MkJBQ2IsaUJBQWlCOzs7OzhCQUNQLHVCQUF1Qjs7MEJBQ25DLG1CQUFtQjs7Ozs4QkFDRSx1QkFBdUI7O0FBRzVELElBQU0sYUFBYSwrREFBNkQsQ0FBQztBQUNqRixJQUFNLGNBQWMseUZBQXVGLENBQUM7O0FBRTVHLElBQU0sY0FBYyxHQUFHLHFCQUFxQixDQUFDO0FBQzdDLElBQU0scUJBQXFCLEdBQUcsbUJBQW1CLENBQUM7QUFDbEQsSUFBTSxpQkFBaUIsR0FBRyxhQUFhLENBQUM7QUFDeEMsSUFBTSxpQkFBaUIsR0FBRyxhQUFhLENBQUM7QUFDeEMsSUFBTSxpQkFBaUIsR0FBRyxhQUFhLENBQUM7O0FBRXhDLFFBQVEsQ0FBQywyQkFBMkIsRUFBRSxZQUFZO0FBQ2hELE1BQUksQ0FBQyxPQUFPLHNDQUFzQixDQUFDOztBQUVuQyxNQUFNLE1BQU0sR0FBRyw4QkFBTSxJQUFJLHVCQUFVLENBQUMsTUFBTSxDQUFDOztBQUUzQyxVQUFRLENBQUMsUUFBUSxFQUFFLFlBQVk7OztBQUM3QixjQUFVLENBQUM7Ozs7OzZDQUFrQix1REFFM0IsTUFBTSxFQUNILHdCQUFJLGNBQWMsb0JBQ3JCLHFCQUFxQixDQUN0Qjs7Ozs7Ozs7OztLQUFBLENBQUMsQ0FBQzs7QUFFSCxNQUFFLENBQUMsZ0NBQWdDLEVBQUU7VUFJL0IsRUFBRTs7Ozs7NkNBSEEsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUM7Ozs7NkNBQ3ZCLE1BQU0sQ0FBQyxLQUFLLEVBQUU7Ozs2QkFBa0IsY0FBYzs2QkFBOUIsTUFBTSxDQUFDLEVBQUUsQ0FBQyxLQUFLOzs2Q0FFdkIsTUFBTSxDQUFDLFdBQVcsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDOzs7QUFBL0MsY0FBRTs7NkNBQ0MsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENB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USxDQUFDLFNBQVMsQ0FBQzs7Ozs2Q0FFUixNQUFNLENBQUMsYUFBYSxFQUFFOzs7QUFBMUMsdUJBQVc7O0FBQ2YsdUJBQVcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUM7QUFDOUMsdUJBQVcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDOzs7Ozs7O0tBQ3ZELENBQUMsQ0FBQztHQUNKLENBQUMsQ0FBQztDQUNKLENBQUMsQ0FBQyIsImZpbGUiOiJ0ZXN0L2UyZS9zYWZhcmkvd2Vidmlldy9mcmFtZXMtc3BlY3MuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZGVzaXJlZCBmcm9tICcuL2Rlc2lyZWQnO1xuaW1wb3J0IHNldHVwIGZyb20gJy4uL3NhZmFyaS1zZXR1cCc7XG5pbXBvcnQgeyBsb2FkV2ViVmlldyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvd2Vidmlldyc7XG5pbXBvcnQgZW52IGZyb20gJy4uLy4uL2hlbHBlcnMvZW52JztcbmltcG9ydCB7IE1PQ0hBX1NBRkFSSV9USU1FT1VUIH0gZnJvbSAnLi4vLi4vaGVscGVycy9zZXNzaW9uJztcblxuXG5jb25zdCBHRVRfRUxFTV9TWU5DID0gYHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaDEnKVswXS5pbm5lckhUTUw7YDtcbmNvbnN0IEdFVF9FTEVNX0FTWU5DID0gYGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0oZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2gxJylbMF0uaW5uZXJIVE1MKTtgO1xuXG5jb25zdCBGUkFNRVNFVF9USVRMRSA9ICdGcmFtZXNldCBndWluZWEgcGlnJztcbmNvbnN0IElGUkFNRV9GUkFNRVNFVF9USVRMRSA9ICdJZnJhbWUgZ3VpbmVhIHBpZyc7XG5jb25zdCBTVUJfRlJBTUVfMV9USVRMRSA9ICdTdWIgZnJhbWUgMSc7XG5jb25zdCBTVUJfRlJBTUVfMl9USVRMRSA9ICdTdWIgZnJhbWUgMic7XG5jb25zdCBTVUJfRlJBTUVfM19USVRMRSA9ICdTdWIgZnJhbWUgMyc7XG5cbmRlc2NyaWJlKCdzYWZhcmkgLSB3ZWJ2aWV3IC0gZnJhbWVzJywgZnVuY3Rpb24gKCkge1xuICB0aGlzLnRpbWVvdXQoTU9DSEFfU0FGQVJJX1RJTUVPVVQpO1xuXG4gIGNvbnN0IGRyaXZlciA9IHNldHVwKHRoaXMsIGRlc2lyZWQpLmRyaXZlcjtcblxuICBkZXNjcmliZSgnZnJhbWVzJywgZnVuY3Rpb24gKCkge1xuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4gYXdhaXQgbG9hZFdlYlZpZXcoXG4gICAgICBkZXNpcmVkLFxuICAgICAgZHJpdmVyLFxuICAgICAgYCR7ZW52LlRFU1RfRU5EX1BPSU5UfWZyYW1lc2V0Lmh0bWxgLFxuICAgICAgJ0ZyYW1lc2V0IGd1aW5lYSBwaWcnXG4gICAgKSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBmcmFtZSBieSBuYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKCdmaXJzdCcpO1xuICAgICAgKGF3YWl0IGRyaXZlci50aXRsZSgpKS5zaG91bGQuYmUuZXF1YWwoRlJBTUVTRVRfVElUTEUpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoU1VCX0ZSQU1FXzFfVElUTEUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzd2l0Y2ggdG8gZnJhbWUgYnkgaW5kZXgnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoMSk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbChGUkFNRVNFVF9USVRMRSk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbChTVUJfRlJBTUVfMl9USVRMRSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBmcmFtZSBieSBpZCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnZnJhbWUzJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbChGUkFNRVNFVF9USVRMRSk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbChTVUJfRlJBTUVfM19USVRMRSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCBiYWNrIHRvIGRlZmF1bHQgY29udGVudCBmcm9tIGZyYW1lJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKCdmaXJzdCcpO1xuICAgICAgKGF3YWl0IGRyaXZlci50aXRsZSgpKS5zaG91bGQuYmUuZXF1YWwoRlJBTUVTRVRfVElUTEUpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoU1VCX0ZSQU1FXzFfVElUTEUpO1xuXG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUobnVsbCk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmZpbmRFbGVtZW50KCd0YWcgbmFtZScsICdmcmFtZXNldCcpKS5zaG91bGQuZXhpc3Q7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBjaGlsZCBmcmFtZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ3RoaXJkJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbChGUkFNRVNFVF9USVRMRSk7XG5cbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnY2hpbGRmcmFtZScpO1xuICAgICAgKGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgnaWQnLCAnb25seV9vbl9wYWdlXzInKSkuc2hvdWxkLmV4aXN0O1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBleGVjdXRlIGphdmFzY3JpcHQgaW4gZnJhbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZpcnN0Jyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmV4ZWN1dGUoR0VUX0VMRU1fU1lOQykpLnNob3VsZC5iZS5lcXVhbChTVUJfRlJBTUVfMV9USVRMRSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGV4ZWN1dGUgYXN5bmMgamF2YXNjcmlwdCBpbiBmcmFtZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnZmlyc3QnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZXhlY3V0ZUFzeW5jKEdFVF9FTEVNX0FTWU5DKSkuc2hvdWxkLmJlLmVxdWFsKFNVQl9GUkFNRV8xX1RJVExFKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZ2V0IHNvdXJjZSB3aXRoaW4gYSBmcmFtZScsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGxldCBwYWdlU291cmNlID0gYXdhaXQgZHJpdmVyLmdldFBhZ2VTb3VyY2UoKTtcbiAgICAgIHBhZ2VTb3VyY2Uuc2hvdWxkLmluY2x1ZGUoRlJBTUVTRVRfVElUTEUpO1xuXG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2ZpcnN0Jyk7XG5cbiAgICAgIGxldCBmcmFtZVNvdXJjZSA9IGF3YWl0IGRyaXZlci5nZXRQYWdlU291cmNlKCk7XG4gICAgICBmcmFtZVNvdXJjZS5zaG91bGQuaW5jbHVkZShTVUJfRlJBTUVfMV9USVRMRSk7XG4gICAgICBmcmFtZVNvdXJjZS5zaG91bGQubm90LmluY2x1ZGUoRlJBTUVTRVRfVElUTEUpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnaWZyYW1lcycsIGZ1bmN0aW9uICgpIHtcbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IGF3YWl0IGxvYWRXZWJWaWV3KFxuICAgICAgZGVzaXJlZCxcbiAgICAgIGRyaXZlcixcbiAgICAgIGAke2Vudi5URVNUX0VORF9QT0lOVH1pZnJhbWVzLmh0bWxgLFxuICAgICAgJ0lmcmFtZSBndWluZWEgcGlnJ1xuICAgICkpO1xuXG4gICAgaXQoJ3Nob3VsZCBzd2l0Y2ggdG8gaWZyYW1lIGJ5IG5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2lmcmFtZTEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKElGUkFNRV9GUkFNRVNFVF9USVRMRSk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbChTVUJfRlJBTUVfMV9USVRMRSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHN3aXRjaCB0byBpZnJhbWUgYnkgaW5kZXgnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoMSk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbChJRlJBTUVfRlJBTUVTRVRfVElUTEUpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoU1VCX0ZSQU1FXzJfVElUTEUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzd2l0Y2ggdG8gaWZyYW1lIGJ5IGlkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZHJpdmVyLnNldEZyYW1lKCdpZC1pZnJhbWUzJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbChJRlJBTUVfRlJBTUVTRVRfVElUTEUpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoU1VCX0ZSQU1FXzNfVElUTEUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzd2l0Y2ggdG8gaWZyYW1lIGJ5IGVsZW1lbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgZnJhbWUgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ2lkJywgJ2lkLWlmcmFtZTMnKTtcbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZShmcmFtZSk7XG4gICAgICAoYXdhaXQgZHJpdmVyLnRpdGxlKCkpLnNob3VsZC5iZS5lcXVhbChJRlJBTUVfRlJBTUVTRVRfVElUTEUpO1xuXG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICAoYXdhaXQgZHJpdmVyLmdldFRleHQoaDEpKS5zaG91bGQuYmUuZXF1YWwoU1VCX0ZSQU1FXzNfVElUTEUpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBub3Qgc3dpdGNoIHRvIGlmcmFtZSBieSBlbGVtZW50IG9mIHdyb25nIHR5cGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgaDEgPSBhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnQoJ3RhZyBuYW1lJywgJ2gxJyk7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoaDEpLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzd2l0Y2ggYmFjayB0byBkZWZhdWx0IGNvbnRlbnQgZnJvbSBpZnJhbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBkcml2ZXIuc2V0RnJhbWUoJ2lmcmFtZTEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIudGl0bGUoKSkuc2hvdWxkLmJlLmVxdWFsKElGUkFNRV9GUkFNRVNFVF9USVRMRSk7XG5cbiAgICAgIGxldCBoMSA9IGF3YWl0IGRyaXZlci5maW5kRWxlbWVudCgndGFnIG5hbWUnLCAnaDEnKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZ2V0VGV4dChoMSkpLnNob3VsZC5iZS5lcXVhbChTVUJfRlJBTUVfMV9USVRMRSk7XG5cbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZShudWxsKTtcbiAgICAgIChhd2FpdCBkcml2ZXIuZmluZEVsZW1lbnRzKCd0YWcgbmFtZScsICdpZnJhbWUnKSkuc2hvdWxkLmhhdmUubGVuZ3RoKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZXQgc291cmNlIHdpdGhpbiBhbiBpZnJhbWUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBsZXQgcGFnZVNvdXJjZSA9IGF3YWl0IGRyaXZlci5nZXRQYWdlU291cmNlKCk7XG4gICAgICBwYWdlU291cmNlLnNob3VsZC5pbmNsdWRlKElGUkFNRV9GUkFNRVNFVF9USVRMRSk7XG5cbiAgICAgIGF3YWl0IGRyaXZlci5zZXRGcmFtZSgnaWZyYW1lMScpO1xuXG4gICAgICBsZXQgZnJhbWVTb3VyY2UgPSBhd2FpdCBkcml2ZXIuZ2V0UGFnZVNvdXJjZSgpO1xuICAgICAgZnJhbWVTb3VyY2Uuc2hvdWxkLmluY2x1ZGUoU1VCX0ZSQU1FXzFfVElUTEUpO1xuICAgICAgZnJhbWVTb3VyY2Uuc2hvdWxkLm5vdC5pbmNsdWRlKElGUkFNRV9GUkFNRVNFVF9USVRMRSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uLy4uLy4uIn0=
